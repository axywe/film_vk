# Фильмотека

## Задание
<p><p>Необходимо разработать бэкенд приложения “Фильмотека”, который предоставляет REST API для управления базой данных фильмов.</p>

<p>Приложение должно поддерживать следующие функции:</p>

<ul>
	<li>добавление информации об актёре (имя, пол, дата рождения),</li>
	<li>изменение информации об актёре.</li>
</ul>

<p>Возможно изменить любую информацию об актёре, как частично, так и полностью:</p>

<ul>
	<li>удаление информации об актёре,</li>
	<li>добавление информации о фильме.</li>
</ul>

<p>При добавлении фильма указываются его название (не менее 1 и не более 150 символов), описание (не более 1000 символов), дата выпуска, рейтинг (от 0 до 10) и список актёров:</p>

<ul>
	<li>изменение информации о фильме.</li>
</ul>

<p>Возможно изменить любую информацию о фильме, как частично, так и полностью:</p>

<ul>
	<li>удаление информации о фильме,</li>
	<li>получение списка фильмов с возможностью сортировки по названию, по рейтингу, по дате выпуска. По умолчанию используется сортировка по рейтингу (по убыванию),</li>
	<li>поиск фильма по фрагменту названия, по фрагменту имени актёра,</li>
	<li>получение списка актёров, для каждого актёра выдаётся также список фильмов с его участием,</li>
	<li>API должен быть закрыт авторизацией,</li>
	<li>поддерживаются две роли пользователей - обычный пользователь и администратор. Обычный пользователь имеет доступ только на получение данных и поиск, администратор - на все действия. Для упрощения можно считать, что соответствие пользователей и ролей задаётся вручную (например, напрямую через БД).</li>
</ul>

<p>Требования к реализации:</p>

<ul>
	<li>язык реализации - go,</li>
	<li>для хранения данных используется реляционная СУБД (предпочтительно - PostgreSQL),</li>
	<li>предоставлена спецификация на API (в формате Swagger 2.0 или OpenAPI 3.0).</li>
</ul>

<p>Бонус: используется подход api-first (генерация кода из спецификации) или code-first (генерация спецификации из кода).</p>

<ul>
	<li>Для реализации http сервера разрешается использовать только стандартную библиотеку http (без фреймворков),</li>
	<li>логирование - в лог должна попадать базовая информация об обрабатываемых запросах, ошибки,</li>
	<li>код приложения покрыт юнит-тестами не менее чем на 70%,</li>
	<li>Dockerfile для сборки образа,</li>
	<li>docker-compose файл для запуска окружения с работающим приложением и СУБД.</li>
</ul></p>

## Необходимые инструменты

- Docker
- Go 1.17
- PostgreSQL

## Установка и запуск

Создайте файл .env в корне проекта и укажите в нем переменные окружения:
```
POSTGRES_USER=filmotheka_user
POSTGRES_PASSWORD=filmotheka_pass
POSTGRES_DB=filmotheka_db
POSTGRES_PORT=5432
POSTGRES_HOST=db
SERVER_PORT=8080
```
После этого можно запустить приложение с помощью команды:
```bash
docker-compose up --build
```

## Тестирование

```bash
go test ./... -v -coverprofile=test/cover.out && go tool cover -html=test/cover.out -o test/cover.html&& open test/cover.html
```